!function(t){"use strict";t.hdp||(t.hdp={});var e=t.hdp;e.version="0.1.2";var n=navigator.userAgent.toLowerCase(),i="**hdp:环境不是容器",o="**hdp:没有对应的接口:",s="",c=!1,r=function(t){try{return t&&"string"==typeof t?JSON.parse(t):t}catch(e){return t}},a=function(t){if(t)return n.indexOf(t)>-1;for(var e=["mogujie","tt4android","tt4ios","uni4android","uni4iphone","go4android","go4iphone","xiaodian4android","xiaodian4iphone","ambuyer","amcustomer","meilishuo","xcore"],i=0,o=e.length;i<o;i++)if(n.indexOf(e[i])>-1)return!0;return!1},u=["","setTitle","setIcon","pushWindow","popWindow","popToRoot","sendNotification","registerNotification","sendEvent","tips","setNavgationBackground","setStatusBarLight","postResult",""].join("-"),f=function(t,e,n,i){var o=t.split(".");if(o=o[o.length-1],u.indexOf("-"+o+"-")>-1)return e;switch(t){case"mgj.sms.send":case"mgj.device.signParams":e.push(function(t){t=r(t),n(t)},function(t){i(t)});break;case"mgj.location.pickLocationInfo":case"mgj.app.isInstalled":e.unshift(function(t){t=r(t),n(t)});break;case"navigator.notification.alert":case"navigator.notification.confirm":e.splice(1,0,function(t){n(t)});break;case"mgj.ajax.ajax":case"mgj.ajax.ajaxOrigin":var s=e[0];if(s.success){var c=s.success;s.success=function(t){c.apply(null,arguments),n(t)}}else s.success=function(t){n(t)};s.error||(s.error=function(t){i(t)});break;default:e.unshift(function(e){e=r(e),"mgj.user.getUserInfo"==t&&e.result?n(e.result):"mgj.device.getInfo"==t&&e.deviceId?(e.deviceID=e.deviceId,n(e)):n(e)},function(t){i(t)})}return e},l=t.Promise;if(!l||n.indexOf("xcore")>0){var d=function(t){this.state="pending",this.value=null,this.reason=null,this.callback={isDispatch:!1},"function"==typeof t&&t.call(null,this.resolve.bind(this),this.reject.bind(this))};d.prototype.resolve=function(t){"pending"==this.state&&(this.state="fulfilled",this.value=t,this._dispatch())},d.prototype.reject=function(t){"pending"==this.state&&(this.state="rejected",this.reason=t,this._dispatch())},d.prototype.then=function(t,e){return"function"==typeof t&&(this.callback.fulfill=t),"function"==typeof e&&(this.callback.reject=e),"pending"!=this.state&&setTimeout(function(){this._dispatch()}.bind(this),10),this.callback.promise=new d,this.callback.promise},d.prototype["catch"]=function(t){return this.then(null,t)},d.prototype._dispatch=function(){if("pending"!=this.state&&!this.callback.isDispatch){var t=this.callback,e=t.promise,n=null;try{switch(this.state){case"fulfilled":if(!t.fulfill)return e&&e.resolve(this.value);n=t.fulfill(this.value),t.isDispatch=!0;break;case"rejected":if(!t.reject)return e&&e.reject(this.reason);n=t.reject(this.reason),t.isDispatch=!0}null===n||void 0===n?e.resolve(n):n instanceof d||"function"==typeof n.then?n.then(e.resolve.bind(e),e.reject.bind(e)):e.resolve(n)}catch(i){e.reject(i)}}},l=d}var p="",h=function(t,e,n){return"732"==p||"733"==p?void n(o):(t.unshift(function(t){e(t)},function(t){n(t)}),s&&t.unshift(s),void(mgj.ajax&&mgj.ajax.mwp?mgj.ajax.mwp.apply(null,t):n(o)))},g=function(t,n){if("mgj.ajax.mwp"==t)return new l(function(t,i){p?h(n,t,i):e["do"]("mgj.device.getInfo").then(function(e){p=e.appVersion,h(n,t,i)})})},v=function(t){return new l(function(e,n){c?window[t]?e(window[t]):n(o):a()?document.addEventListener("deviceready",function(){c=!0,window[t]?e(window[t]):n(o)},!1):n(i)})},j=function(t,e){if(3!=e.length){for(var n=t,i=1,o=e.length;i<o&&(n=n[e[i]],n);i++)if(i==o-1)return n}else if(t[e[1]])return t[e[1]][e[2]]},m=function(t,e,n,i,o){var c=e.concat(),a=function(e){e=r(e),"mgj.user.getUserInfo"==t&&e.result?n(e.result):"mgj.device.getInfo"==t&&e.deviceId?(e.deviceID=e.deviceId,n(e)):n(e)},u=function(t,e,n){i(n?n:t)};return"mgj.pevent"!=t||o?"uni.resultnotification.postResult"==t?c.unshift(s):"mgj.navigation.setDropMenu"==t?c.unshift(s):"mgj.navigation.setNavigationBarRightIcons"==t?c.unshift(s):c.unshift(s,a,u):c.unshift(a,u),c};e.isApp=a,e.getObj=v,e.setSecret=function(t){s=t},"object"==typeof cordova&&cordova.hdp_secret&&(s=cordova.hdp_secret),e.exec=function(t){if(t){var e=Array.prototype.slice.call(arguments,1),n=t.split(".");if("mgj.ajax.mwp"==t)return g(t,e);var i=null;return new l(function(c,r){v(n[0]).then(function(a){i=j(a,n),i||r(o+t);var u=i.hdp_wrap_fn;s?e=m(t,e,c,r,u):(console.log("**hdp:未注入birdgeSecret"),e=f(t,e,c,r)),i&&i.apply(null,e)})["catch"](function(t){r(t)})})}},e["do"]=e.exec,"undefined"!=typeof module&&"object"==typeof exports?module.exports=e:"function"==typeof define&&(define.amd||define.cmd)&&define("hdp",function(){return e})}(window);